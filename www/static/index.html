<html>

<head>
    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.5.0/build/ol.js"></script>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.5.0/css/ol.css">
    <script src="https://unpkg.com/vue@next"></script>
</head>

<body>
    <h1>I Seek You</h1>
    <p>Community Search and Rescue</p>

    <div id="isyou">
        <seeks></seeks>
    </div>

    <div id="map" class="map"></div>

    <script type="text/javascript">
        var tileLayer = new ol.layer.Tile({
            source: new ol.source.OSM(),
        });

        var map = new ol.Map({
            layers: [tileLayer],
            target: 'map',
            view: new ol.View({
                center: [0, 0],
                zoom: 2,
            }),
        });


        var app = Vue.createApp({});

        app.component('seeks', {
            template: `
                <h2>Active seeks</h2>
                <ol>
                    <li v-for="todo in todos">
                        {{ todo }}
                        <seek></seek>
                    </li>
                </ol>
                <button v-on:click="createSeek">Create Seek</button>
            `,
            data() {
                return {
                    todos: []
                }
            },
            methods: {
                createSeek: function (event) {
                    fetch("backend/seeks", { method: "POST" })
                        .then((response) => { alert(response); })
                }
            },
            mounted() {
                setInterval(() => {
                    fetch("backend/seeks")
                        .then(response => response.json())
                        .then(response => this.todos = response)
                }, 1000);
            }
        });

        app.component('seek', {
            template: `
                <button @click="modalOpen = true">
                    Enter
                </button>

                <div v-if="modalOpen" class="modal">
                <div>
                    I'm a modal! 
                    <button @click="modalOpen = false">
                    Close
                    </button>
                </div>
                </div>
            `,
            data() {
                return {
                    modalOpen: false
                }
            }
        });

        app.mount('#isyou');
    </script>
</body>

</html>